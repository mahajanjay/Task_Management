<div class="w-100 add-task-section_container">
  @for(item of sectionList; let sectionIndex = $index; track $index) { @let last = $last;

  <div class="task_section" [ngClass]="{ 'border-bottom': !last }">
    <button class="w-100 btn-setting d-flex justify-between align-center">
      <div>{{ item.sectionTitle.title }}</div>
      <div class="material-symbols-outlined">settings</div>
    </button>
    @if(item.contentList.length) {
      <section class="section-content">
        @switch(item.sectionTitle.type) {
          @case('strip') {
            @for(content of item.contentList; let contentIndex = $index; track $index;) {
              <ng-container *ngTemplateOutlet="contentTemplateStrip; context: { $implicit: content, sectionIndex, contentIndex }"></ng-container>
            }
          }
          @case ('chip') {
            <div class="d-flex gap">
              @for(content of item.contentList; let contentIndex = $index; track $index;) {
                <ng-container *ngTemplateOutlet="contentTemplateChip; context: { $implicit: content, sectionIndex, contentIndex }"></ng-container>
              }
            </div>
          }
          @case ('input') {
              <ng-container *ngTemplateOutlet="contentTemplateInput; context: { $implicit: item.contentList[0], sectionIndex, contentIndex: 0 }"></ng-container>
          }
        }
      </section>
    } @else {
      <section class="section-content">
        {{ item.sectionTitle.defaultContentText }}
      </section>
    }
  </div>
  }
</div>

<ng-template #contentTemplateChip let-content let-sectionIndex="sectionIndex" let-contentIndex="contentIndex">
  <div class="content-chip" [ngStyle]="content.styles"
       [class.selected]="content.selected"
       (click)="onSelect(sectionIndex, contentIndex)">
    {{ content.title }}
  </div>
</ng-template>

<ng-template #contentTemplateStrip let-content let-sectionIndex="sectionIndex" let-contentIndex="contentIndex">
  <div class="content-strip" [class.selected]="content.selected"
       (click)="onSelect(sectionIndex, contentIndex)">
  </div>
</ng-template>

<ng-template #contentTemplateInput let-content let-sectionIndex="sectionIndex" let-contentIndex="contentIndex">
  <input type="text" class="input-txt" [value]="content.value"
    (input)="onInputChange(sectionIndex, contentIndex, $event)">
</ng-template>
